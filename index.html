<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Buscador de Filamentos - Hoho3D Profesional</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* Estilos generales */
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a1e28;
      color: #cde9f8;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    header {
      padding: 20px;
      text-align: center;
      background: #12314a;
      width: 100%;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }
    header h1 {
      margin: 0;
      color: #3fb7a4;
      font-size: 2rem;
    }
    header p {
      margin: 5px 0 0;
      color: #86d0fb;
    }
    main {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 20px;
      width: 90%;
      max-width: 1200px;
      margin: 20px 0;
    }
    .panel {
      background: #12314a;
      border-radius: 12px;
      padding: 20px;
      box-shadow: inset 0 0 12px rgba(63,183,164,0.5);
      display: flex;
      flex-direction: column;
    }
    .panel h2 {
      margin: 0 0 15px;
      color: #3fb7a4;
      font-size: 1.2rem;
    }
    /* Panel izquierdo */
    #searchInput {
      padding: 10px;
      border: none;
      border-radius: 8px;
      background: #0e3d53;
      color: #cde9f8;
      margin-bottom: 15px;
    }
    #colorList {
      flex: 1;
      overflow-y: auto;
    }
    .color-item {
      display: flex;
      align-items: center;
      padding: 8px;
      margin-bottom: 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .color-item:hover, .color-item.selected {
      background: rgba(63,183,164,0.2);
    }
    .color-box {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      margin-right: 12px;
      border: 2px solid #3fb7a4;
      flex-shrink: 0;
    }
    .color-info { flex: 1; }
    .color-name { margin: 0; font-weight: 600; font-size: 0.95rem; }
    .color-hex { margin: 2px 0 0; font-size: 0.8rem; color: #86d0fb; }
    /* Panel central */
    #pickerContainer {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #colorPicker {
      width: 180px;
      height: 180px;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      margin-bottom: 15px;
      box-shadow: 0 0 15px rgba(63,183,164,0.5);
    }
    #selectedInfo {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    #selectedPreview {
      width: 100px;
      height: 100px;
      border-radius: 12px;
      border: 3px solid #3fb7a4;
      background: #000;
      box-shadow: 0 0 20px rgba(63,183,164,0.7);
      margin-bottom: 10px;
    }
    #selectedText {
      font-size: 1rem;
      text-align: center;
    }
    /* Lienzo para modelo 3D */
    #modelCanvas {
      width: 200px;
      height: 200px;
      border-radius: 12px;
      background: #0e3d53;
      box-shadow: 0 0 20px rgba(63,183,164,0.5);
      margin-bottom: 15px;
    }
    /* Ideas */
    #ideaBtn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: #3fb7a4;
      color: #0a1e28;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
      margin-bottom: 15px;
    }
    #ideaBtn:hover { background: #2a8f81; }
    #ideaText {
      font-style: italic;
      color: #86d0fb;
      text-align: center;
      min-height: 2em;
    }
    /* Panel derecho */
    #closestList {
      flex: 1;
      overflow-y: auto;
    }
    .closest-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .closest-item:hover { background: rgba(63,183,164,0.2); }
    .closest-box {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      margin-right: 12px;
      border: 2px solid #3fb7a4;
      flex-shrink: 0;
    }
    .closest-info { font-size: 0.9rem; }
    @media (max-width: 900px) {
      main { grid-template-columns: 1fr; }
      header h1 { font-size: 1.5rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Buscador de Filamentos - Hoho3D Profesional</h1>
    <p>Encuentra el color perfecto para tu impresión 3D</p>
  </header>
  <main>
    <!-- Panel Izquierdo -->
    <div class="panel">
      <h2>Filamentos</h2>
      <input type="text" id="searchInput" placeholder="Buscar por nombre o código hex">
      <div id="colorList"></div>
    </div>
    <!-- Panel Central -->
    <div class="panel" id="pickerContainer">
      <h2>Selector de Color</h2>
      <input type="color" id="colorPicker" value="#5b6770">
      <div id="selectedInfo">
        <div id="selectedPreview"></div>
        <div id="selectedText">Color: #5b6770</div>
      </div>
      <canvas id="modelCanvas"></canvas>
      <button id="ideaBtn">Generar Idea 3D</button>
      <div id="ideaText">Haz clic para obtener una sugerencia...</div>
    </div>
    <!-- Panel Derecho -->
    <div class="panel">
      <h2>Colores Cercanos</h2>
      <div id="closestList"></div>
    </div>
  </main>

  <!-- Three.js y GLTFLoader -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r150/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r150/examples/js/loaders/GLTFLoader.js"></script>

  <script>
  (() => {
    const filaments = [
      {name:"Grilon 3 PLA SILK Platino",hex:"#5b6770",link:"https://www.hoho3d.com.ar/...5b6770"},
      {name:"Grilon 3 PLA Piel 720",hex:"#e7b78a",link:"https://www.hoho3d.com.ar/...e7b78a"},
      {name:"Grilon 3 PLA Gris Plata",hex:"#75787b",link:"https://www.hoho3d.com.ar/...75787b"},
      {name:"Grilon 3 PLA Cobre",hex:"#a1561c",link:"https://www.hoho3d.com.ar/...a1561c"},
      {name:"Grilon 3 PLA Bronce",hex:"#998542",link:"https://www.hoho3d.com.ar/...998542"}
    ];

    // Elementos DOM
    const searchInput = document.getElementById('searchInput');
    const colorList = document.getElementById('colorList');
    const colorPicker = document.getElementById('colorPicker');
    const selectedPreview = document.getElementById('selectedPreview');
    const selectedText = document.getElementById('selectedText');
    const closestList = document.getElementById('closestList');
    const ideaBtn = document.getElementById('ideaBtn');
    const ideaText = document.getElementById('ideaText');

    let selectedHex = colorPicker.value;

    // Utility: hex → rgb
    function hexToRgb(h) {
      return {r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16)};
    }
    function colorDist(a,b) {
      const A=hexToRgb(a), B=hexToRgb(b);
      return Math.hypot(A.r-B.r,A.g-B.g,A.b-B.b);
    }

    // Render lista izquierda
    function renderColorList(filter="") {
      colorList.innerHTML = '';
      filaments.filter(f => f.name.toLowerCase().includes(filter.toLowerCase())||f.hex.includes(filter))
        .forEach(f => {
          const div = document.createElement('div');
          div.className='color-item';
          div.innerHTML=`
            <div class="color-box" style="background:${f.hex}"></div>
            <div class="color-info">
              <p class="color-name">${f.name}</p>
              <p class="color-hex">${f.hex}</p>
            </div>`;
          div.onclick = ()=> selectColor(f.hex);
          colorList.append(div);
        });
    }

    // Render más cercanos
    function renderClosest() {
      const sorted = filaments.slice().sort((a,b)=>colorDist(a.hex,selectedHex)-colorDist(b.hex,selectedHex));
      closestList.innerHTML='';
      sorted.forEach(f=>{
        const div=document.createElement('div');
        div.className='closest-item';
        div.innerHTML=`
          <div class="closest-box" style="background:${f.hex}"></div>
          <div class="closest-info">${f.name}</div>`;
        div.onclick=()=>selectColor(f.hex);
        closestList.append(div);
      });
    }

    // Selección de color
    function selectColor(hex) {
      selectedHex=hex;
      selectedPreview.style.background=hex;
      selectedText.textContent=`Color: ${hex}`;
      colorPicker.value=hex;
      renderClosest();
      updateBirdColor(hex);
    }

    searchInput.oninput = ()=>renderColorList(searchInput.value);
    colorPicker.oninput = ()=>selectColor(colorPicker.value);

    // Generador de ideas
    const ideas = [
      "Imprime un elegante porta lápices en ",
      "Crea un llavero personalizado con ",
      "Diseña un soporte para celular en ",
      "Haz un organizador moderno usando ",
      "Construye una caja minimalista con "
    ];
    ideaBtn.onclick = ()=>{
      const idea = ideas[Math.floor(Math.random()*ideas.length)];
      ideaText.textContent = idea + selectedHex;
    };

    // Three.js + GLTFLoader → pajarito giratorio
    const canvas = document.getElementById('modelCanvas');
    const renderer = new THREE.WebGLRenderer({canvas,antialias:true,alpha:true});
    renderer.setSize(canvas.width,canvas.height);
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45,canvas.width/canvas.height,0.1,100);
    camera.position.set(0,1.5,3);
    const light = new THREE.HemisphereLight(0xffffff,0x444444,1.0);
    scene.add(light);
    const loader = new THREE.GLTFLoader();
    let bird;
    loader.load(
      'https://threejs.org/examples/models/gltf/Parrot.glb',
      gltf => {
        bird=gltf.scene;
        bird.scale.set(0.05,0.05,0.05);
        scene.add(bird);
      }
    );
    // Update bird material tint
    function updateBirdColor(hex) {
      if(!bird) return;
      bird.traverse(o=>{
        if(o.isMesh) o.material.color.set(hex);
      });
    }
    function animate() {
      requestAnimationFrame(animate);
      if(bird) bird.rotation.y += 0.01;
      renderer.render(scene,camera);
    }
    animate();

    // Init
    renderColorList();
    selectColor(selectedHex);
  })();
  </script>
</body>
</html>

