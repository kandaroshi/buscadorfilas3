<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Buscador de Filamentos 3D</title>
<style>
  /* Diseño elegante y moderno, tonos azules y verdes */
  body {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: #e0f7fa;
    display: flex; height: 100vh; overflow: hidden;
  }
  #leftPanel, #centerPanel, #rightPanel {
    padding: 20px;
    box-sizing: border-box;
  }
  #leftPanel {
    width: 280px;
    background: rgba(10, 25, 40, 0.8);
    display: flex; flex-direction: column;
  }
  #centerPanel {
    flex: 1;
    background: rgba(0, 77, 64, 0.8);
    display: flex; flex-direction: column;
    align-items: center;
  }
  #rightPanel {
    width: 320px;
    background: rgba(10, 25, 40, 0.8);
    display: flex; flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  /* Buscador */
  #colorSearch {
    padding: 8px 10px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    margin-bottom: 15px;
    outline: none;
  }

  /* Lista colores izquierda */
  #colorList {
    overflow-y: auto;
    flex-grow: 1;
  }
  .color-item {
    display: flex;
    align-items: center;
    padding: 8px;
    margin-bottom: 6px;
    border-radius: 6px;
    background: rgba(255 255 255 / 0.05);
    cursor: pointer;
    transition: background-color 0.25s ease;
  }
  .color-item:hover, .color-item:focus {
    background: rgba(255 255 255 / 0.15);
    outline: none;
  }
  .color-swatch {
    width: 30px; height: 30px;
    border-radius: 50%;
    margin-right: 12px;
    border: 1.5px solid #004d40;
    box-shadow: 0 0 8px 1px rgba(0, 77, 64, 0.6);
  }
  .color-info {
    display: flex; flex-direction: column;
  }
  .color-name {
    font-weight: 600;
    font-size: 14px;
  }
  .color-hex {
    font-size: 12px;
    color: #b2dfdb;
  }

  /* Panel central rueda */
  #colorWheel {
    width: 280px;
    height: 280px;
    border-radius: 50%;
    background: conic-gradient(
      red 0deg 60deg,
      yellow 60deg 120deg,
      lime 120deg 180deg,
      cyan 180deg 240deg,
      blue 240deg 300deg,
      magenta 300deg 360deg
    );
    cursor: pointer;
    box-shadow: 0 0 12px 4px #004d40;
    margin-bottom: 15px;
    outline: none;
  }
  #colorIndicator {
    width: 60px; height: 60px;
    border-radius: 50%;
    border: 3px solid #e0f7fa;
    box-shadow: 0 0 15px 3px #26a69a;
    margin-bottom: 8px;
  }
  #selectedHex {
    font-size: 18px;
    font-weight: 700;
    letter-spacing: 1.5px;
    user-select: none;
    margin-bottom: 20px;
  }

  /* Lista filamentos centrados por proximidad */
  .filaments-display {
    overflow-y: auto;
    max-height: 200px;
    width: 100%;
    background: rgba(0,0,0,0.2);
    border-radius: 10px;
    padding: 10px;
  }
  .filament-item {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    background: rgba(255 255 255 / 0.1);
    border-radius: 6px;
    padding: 6px 10px;
    transition: background-color 0.2s ease;
  }
  .filament-item:hover {
    background: rgba(255 255 255 / 0.2);
  }
  .filament-color {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    margin-right: 14px;
    border: 1.5px solid #004d40;
    box-shadow: 0 0 8px 2px rgba(0, 77, 64, 0.8);
  }
  .filament-name {
    flex-grow: 1;
    font-weight: 600;
    font-size: 14px;
    color: #b2dfdb;
  }
  .filament-link {
    font-size: 13px;
    color: #80cbc4;
    text-decoration: none;
    font-weight: 500;
  }
  .filament-link:hover {
    text-decoration: underline;
  }

  /* Botón ideas en derecha */
  #generateIdeasBtn {
    padding: 15px 25px;
    font-size: 18px;
    border: none;
    border-radius: 10px;
    background: #009688;
    color: #e0f7fa;
    cursor: pointer;
    box-shadow: 0 0 20px #004d40;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  #generateIdeasBtn:hover {
    background: #00796b;
  }
  #ideasText {
    margin-top: 25px;
    font-size: 16px;
    font-weight: 600;
    color: #b2dfdb;
    text-align: center;
    max-width: 280px;
    user-select: none;
  }
</style>
</head>
<body>

<div id="leftPanel" role="region" aria-label="Listado de filamentos disponibles">
  <input type="text" id="colorSearch" placeholder="Buscar por nombre o código HEX" aria-label="Buscar filamentos por nombre o código hexadecimal" />
  <div id="colorList" role="listbox" tabindex="0"></div>
</div>

<div id="centerPanel" role="main" aria-label="Selector de color y filamentos relacionados">
  <div id="colorIndicator" aria-live="polite" aria-atomic="true" aria-label="Color seleccionado"></div>
  <div id="selectedHex" aria-live="polite" aria-atomic="true">#000000</div>
  <div id="colorWheel" tabindex="0" aria-label="Rueda de selección de color"></div>
  <div class="filaments-display" aria-live="polite" aria-atomic="true"></div>
</div>

<div id="rightPanel" role="region" aria-label="Generador de ideas de impresión 3D">
  <button id="generateIdeasBtn" aria-describedby="ideasText">Generar ideas de impresión 3D</button>
  <div id="ideasText" aria-live="polite" aria-atomic="true"></div>
</div>

<script>
  const filaments = [
    {
      name: "Grilon 3 PLA SILK Platino 1.75mm x 1kg",
      hex: "#5b6770",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/silk/grilon-3-pla-silk-platino-175mm-x-1kg-5b6770"
    },
    {
      name: "Grilon 3 PLA Piel 720 1.75mm x 1KG",
      hex: "#e7b78a",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-piel-720-175mm-x-1kg-e7b78a"
    },
    {
      name: "Grilon 3 PLA Gris Plata 1.75mm x 1kg",
      hex: "#75787b",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-gris-plata-175mm-x-1kg-75787b"
    },
    {
      name: "Grilon 3 PLA Cobre 1.75mm x 1kg",
      hex: "#a1561c",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-cobre-175mm-x-1kg-a1561c"
    },
    {
      name: "Grilon 3 PLA Bronce 1.75mm x 1kg",
      hex: "#998542",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-bronce-175mm-x-1kg-998542"
    }
  ];

  const colorListEl = document.getElementById('colorList');
  const searchInput = document.getElementById('colorSearch');
  const colorWheel = document.getElementById('colorWheel');
  const colorIndicator = document.getElementById('colorIndicator');
  const selectedHexEl = document.getElementById('selectedHex');
  const filamentsDisplay = document.querySelector('.filaments-display');
   colorWheel = document.getElementById('colorWheel');
  const colorIndicator = document.getElementById('colorIndicator');
  const selectedHexEl = document.getElementById('selectedHex');
  const filamentsDisplay = document.querySelector('.filaments-display');
  const generateIdeasBtn = document.getElementById('generateIdeasBtn');
  const ideasText = document.getElementById('ideasText');

  // Función para mostrar lista filtrada en el panel izquierdo
  function renderColorList(filter = '') {
    colorListEl.innerHTML = '';
    const filtered = filaments.filter(f =>
      f.name.toLowerCase().includes(filter.toLowerCase()) ||
      f.hex.toLowerCase().includes(filter.toLowerCase())
    );
    filtered.forEach(filament => {
      const item = document.createElement('div');
      item.className = 'color-item';
      item.tabIndex = 0;
      item.setAttribute('role', 'option');
      item.innerHTML = `
        <div class="color-swatch" style="background:${filament.hex}"></div>
        <div class="color-info">
          <div class="color-name">${filament.name}</div>
          <div class="color-hex">${filament.hex}</div>
        </div>`;
      item.onclick = () => selectColor(filament.hex);
      item.onkeydown = (e) => { if(e.key === 'Enter' || e.key === ' ') { selectColor(filament.hex); e.preventDefault(); } };
      colorListEl.appendChild(item);
    });
  }

  // Convertir hex a HSL para calcular distancia de color
  function hexToHSL(hex) {
    // Convertir a RGB
    let r = parseInt(hex.substring(1,3),16)/255;
    let g = parseInt(hex.substring(3,5),16)/255;
    let b = parseInt(hex.substring(5,7),16)/255;

    let max = Math.max(r,g,b), min = Math.min(r,g,b);
    let h=0, s=0, l=(max+min)/2;

    if(max === min){
      h = s = 0; // achromatic
    } else {
      let d = max - min;
      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
      switch(max){
        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
        case g: h = (b - r) / d + 2; break;
        case b: h = (r - g) / d + 4; break;
      }
      h /= 6;
    }
    return [h*360, s*100, l*100];
  }

  // Distancia euclidiana simple entre colores en HSL
  function colorDistance(hsl1, hsl2) {
    return Math.sqrt(
      Math.pow(hsl1[0]-hsl2[0],2) +
      Math.pow(hsl1[1]-hsl2[1],2) +
      Math.pow(hsl1[2]-hsl2[2],2)
    );
  }

  // Mostrar los filamentos ordenados por proximidad al color seleccionado
  function renderClosestFilaments(selectedHex) {
    const selectedHSL = hexToHSL(selectedHex);
    const sorted = filaments
      .map(f => ({
        ...f,
        distance: colorDistance(selectedHSL, hexToHSL(f.hex))
      }))
      .sort((a,b) => a.distance - b.distance);
    
    filamentsDisplay.innerHTML = '';
    sorted.forEach(filament => {
      const elem = document.createElement('div');
      elem.className = 'filament-item';
      elem.innerHTML = `
        <div class="filament-color" style="background:${filament.hex}"></div>
        <div class="filament-name">${filament.name}</div>
        <a class="filament-link" href="${filament.link}" target="_blank" rel="noopener noreferrer" aria-label="Ver producto ${filament.name}">Ver producto</a>
      `;
      filamentsDisplay.appendChild(elem);
    });
  }

  // Selección color: actualizar rueda, indicador y lista
  function selectColor(hex) {
    colorIndicator.style.backgroundColor = hex;
    selectedHexEl.textContent = hex.toUpperCase();
    renderClosestFilaments(hex);
  }

  // Control de la rueda (simple interacción simulada)
  colorWheel.addEventListener('click', e => {
    // Obtener ángulo en la rueda para definir color (simplificado)
    const rect = colorWheel.getBoundingClientRect();
    const centerX = rect.left + rect.width/2;
    const centerY = rect.top + rect.height/2;
    const dx = e.clientX - centerX;
    const dy = e.clientY - centerY;
    let angle = Math.atan2(dy, dx) * (180/Math.PI);
    if(angle < 0) angle += 360;
    // Convertir ángulo a color con HSL para rueda
    const h = angle;
    const s = 100;
    const l = 50;
    const hex = hslToHex(h,s,l);
    selectColor(hex);
  });

  // Convertir HSL a HEX
  function hslToHex(h,s,l){
    s /= 100;
    l /= 100;
    const c = (1 - Math.abs(2*l -1)) * s;
    const x = c * (1 - Math.abs((h/60) % 2 -1));
    const m = l - c/2;
    let r=0,g=0,b=0;

    if(h>=0 && h<60) {r=c;g=x;b=0;}
    else if(h>=60 && h<120) {r=x;g=c;b=0;}
    else if(h>=120 && h<180) {r=0;g=c;b=x;}
    else if(h>=180 && h<240) {r=0;g=x;b=c;}
    else if(h>=240 && h<300) {r=x;g=0;b=c;}
    else {r=c;g=0;b=x;}

    r = Math.round((r + m) * 255);
    g = Math.round((g + m) * 255);
    b = Math.round((b + m) * 255);

    return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
  }

  // Filtro en buscador
  searchInput.addEventListener('input', e => {
    renderColorList(e.target.value);
  });

  // Generador de ideas usando solo colores en stock
  generateIdeasBtn.addEventListener('click', () => {
    const randomFilaments = filaments.sort(() => 0.5 - Math.random()).slice(0,3);
    const ideas = [
      `Imprime una figura geométrica elegante usando el color ${randomFilaments[0].name.split('-')[1].trim()}`,
      `Crea un soporte funcional con un acabado metálico similar a ${randomFilaments[1].name.split('-')[1].trim()}`,
      `Diseña una carcasa personalizada usando el tono de ${randomFilaments[2].name.split('-')[1].trim()}`
    ];
    ideasText.textContent = ideas.join('. ');
  });

  // Inicialización
  renderColorList();
  selectColor(filaments[0].hex);
</script>
</body>
</html>

