<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Buscador Hoho3D - Filamentos 3D</title>
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color: #d1e8e2;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }
  a {
    color: #5de1df;
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
  h1, h2, h3 {
    margin: 0 0 0.5rem 0;
    color: #a4f9c8;
  }
  button {
    cursor: pointer;
    background-color: #176d6e;
    border: none;
    color: #d1e8e2;
    font-weight: 700;
    font-size: 1rem;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    transition: background-color 0.3s ease;
    box-shadow: 0 4px 8px rgba(23,109,110,0.5);
  }
  button:hover {
    background-color: #2dc3c4;
    color: #073636;
  }
  /* Layout general */
  #app {
    display: flex;
    flex: 1;
    padding: 1rem 1.5rem;
    gap: 1rem;
  }
  /* Columna izquierda: Stock vertical */
  #stock-container {
    flex: 0 0 280px;
    background: rgba(23,109,110,0.2);
    border-radius: 12px;
    padding: 1rem;
    display: flex;
    flex-direction: column;
  }
  #stock-container h2 {
    margin-bottom: 0.7rem;
    text-align: center;
    color: #7ee8fa;
    text-shadow: 0 0 8px #7ee8fa;
  }
  #search-input {
    padding: 0.5rem;
    border-radius: 6px;
    border: none;
    font-size: 1rem;
    margin-bottom: 1rem;
    outline: none;
    box-shadow: inset 0 0 5px #5de1df;
    background-color: #142d33;
    color: #d1e8e2;
  }
  #filament-list {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    padding-right: 6px;
  }
  .filament-item {
    background: rgba(45,195,196,0.1);
    border-radius: 8px;
    display: flex;
    align-items: center;
    padding: 0.5rem 0.75rem;
    gap: 1rem;
    box-shadow: 0 0 10px rgba(45,195,196,0.25);
    transition: background-color 0.3s ease;
  }
  .filament-item:hover {
    background: rgba(45,195,196,0.3);
  }
  .color-box {
    width: 32px;
    height: 32px;
    border-radius: 6px;
    border: 1.5px solid #5de1df;
    flex-shrink: 0;
  }
  .filament-info {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  .filament-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: #a4f9c8;
  }
  .filament-hex {
    font-family: monospace;
    font-size: 0.85rem;
    color: #7ee8fa;
  }
  /* Centro: Rueda y preview + botón */
  #center-panel {
    flex: 1;
    background: rgba(23,109,110,0.15);
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    padding: 1rem 1.5rem;
    box-shadow: 0 0 25px #27c6c9;
  }
  #color-wheel-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }
  canvas#color-wheel {
    border-radius: 50%;
    box-shadow: 0 0 30px #5de1df;
    cursor: pointer;
  }
  #selected-color-display {
    margin-top: 1rem;
    text-align: center;
    font-size: 1.2rem;
    font-weight: 700;
    color: #5de1df;
    text-shadow: 0 0 8px #5de1df;
  }
  #color-preview {
    margin: 1rem auto 0;
    width: 140px;
    height: 140px;
    background-color: #5de1df;
    border-radius: 16px;
    box-shadow: 0 0 25px #27c6c9 inset;
    transform-style: preserve-3d;
    animation: rotate3d 12s linear infinite;
    border: 3px solid #0f5a5b;
  }
  @keyframes rotate3d {
    0% { transform: rotateX(0deg) rotateY(0deg);}
    100% { transform: rotateX(360deg) rotateY(360deg);}
  }
  /* Botón de sugerencias */
  #suggestions-container {
    margin-top: 1.8rem;
    text-align: center;
  }
  #suggestion-btn {
    width: 180px;
    font-size: 1.1rem;
  }
  #suggestion-text {
    margin-top: 0.8rem;
    font-style: italic;
    color: #7ee8fa;
    font-weight: 600;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.8rem;
  }
  .suggestion-color-box {
    width: 24px;
    height: 24px;
    border-radius: 5px;
    border: 1.2px solid #5de1df;
  }
  /* Derecha: Colores más cercanos */
  #right-panel {
    flex: 0 0 320px;
    background: rgba(23,109,110,0.2);
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 0 20px #27c6c9;
    display: flex;
    flex-direction: column;
  }
  #right-panel h2 {
    color: #7ee8fa;
    text-shadow: 0 0 8px #7ee8fa;
    margin-bottom: 0.7rem;
    text-align: center;
  }
  #closest-colors-list {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    padding-right: 6px;
  }
  .closest-color-item {
    background: rgba(45,195,196,0.12);
    border-radius: 8px;
    padding: 0.5rem 0.75rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    box-shadow: 0 0 8px rgba(45,195,196,0.3);
    font-weight: 700;
    color: #a4f9c8;
  }
  .closest-color-box {
    width: 28px;
    height: 28px;
    border-radius: 6px;
    border: 1.5px solid #5de1df;
    flex-shrink: 0;
  }
  /* Scrollbars personalizados (solo para Chrome/Edge/Opera) */
  #filament-list::-webkit-scrollbar,
  #closest-colors-list::-webkit-scrollbar {
    width: 8px;
  }
  #filament-list::-webkit-scrollbar-thumb,
  #closest-colors-list::-webkit-scrollbar-thumb {
    background-color: #27c6c9;
    border-radius: 4px;
  }
  #filament-list::-webkit-scrollbar-track,
  #closest-colors-list::-webkit-scrollbar-track {
    background-color: transparent;
  }
</style>
</head>
<body>
  <div id="app">
    <!-- Columna izquierda: Stock con buscador -->
    <section id="stock-container" aria-label="Lista de filamentos en stock">
      <h2>Filamentos en Stock</h2>
      <input type="text" id="search-input" placeholder="Buscar por nombre o hex..." aria-label="Buscar filamentos" />
      <div id="filament-list" role="list" aria-live="polite" aria-atomic="true">
        <!-- Filamentos se cargan aquí -->
      </div>
    </section>

    <!-- Centro: Rueda de color + preview + botón sugerencias -->
    <section id="center-panel" aria-label="Selector y sugerencias de colores">
      <div id="color-wheel-container" aria-label="Rueda de colores">
        <canvas id="color-wheel" width="300" height="300" role="img" aria-describedby="wheel-desc"></canvas>
        <p id="wheel-desc" class="sr-only">Rueda de color continua para selección</p>
      </div>
      <div id="selected-color-display" aria-live="polite" aria-atomic="true">Color seleccionado: <span id="selected-color">#5de1df</span></div>
      <div id="color-preview" aria-label="Previsualización color"></div>
      <div id="suggestions-container">
        <button id="suggestion-btn" aria-label="Generar idea de impresión 3D con color del stock">Generar idea 3D aleatoria</button>
        <div id="suggestion-text" aria-live="polite" aria-atomic="true"></div>
      </div>
    </section>

    <!-- Derecha: Lista colores más cercanos -->
    <aside id="right-panel" aria-label="Colores disponibles en stock">
      <h2>Colores Disponibles</h2>
      <div id="closest-colors-list" role="list" aria-live="polite" aria-atomic="true">
        <!-- Lista de colores se genera aquí -->
      </div>
    </aside>
  </div>

<script>
  'use strict';

  // Filamentos con datos + links (tu stock completo)
  const filaments = [
    {name:"Grilon 3 PLA SILK Platino 1.75mm x 1kg", hex:"#5b6770", link:"https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/silk/grilon-3-pla-silk-platino-175mm-x-1kg-5b6770"},
    {name:"Grilon 3 PLA Piel 720 1.75mm x 1KG", hex:"#e7b78a", link:"https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-piel-720-175mm-x-1kg-e7b78a"},
    {name:"Grilon 3 PLA Gris Plata 1.75mm x 1kg", hex:"#75787b", link:"https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-gris-plata-175mm-x-1kg-75787b"},
    {name:"Grilon 3 PLA Cobre 1.75mm x 1kg", hex:"#a1561c", link:"https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-cobre-175mm-x-1kg-a1561c"},
    {name:"Grilon 3 PLA Bronce 1.75mm x 1kg", hex:"#998542", link:"https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-bronce-175mm-x-1kg-998542"},
  ];

  // Ideas para impresión 3D (puedes expandirlo)
  const ideas = [
    "Soporte para celular ergonómico",
    "Maceta geométrica para escritorio",
    "Llaveros personalizados",
    "Mini figura decorativa",
    "Porta auriculares flexible",
    "Organizador modular para cables",
    "Sujetador para mascarillas",
    "Separadores ajustables para libros",
    "Soporte para botella deportiva",
    "Clip para sujetar cables",
  ];

  // Selección del DOM
  const filamentList = document.getElementById('filament-list');
  const searchInput = document.getElementById('search-input');
  const closestColorsList = document.getElementById('closest-colors-list');
  const selectedColorDisplay = document.getElementById('selected-color');
  const colorPreview = document.getElementById('color-preview');
  const suggestionBtn = document.getElementById('suggestion-btn');
  const suggestionText = document.getElementById('suggestion-text');
  const colorWheelCanvas = document.getElementById('color-wheel');
  const ctx = colorWheelCanvas.getContext('2d');
  const wheelRadius = colorWheelCanvas.width / 2;

  // Función para pintar rueda de color continua
  function drawColorWheel() {
    const imageData = ctx.createImageData(colorWheelCanvas.width, colorWheelCanvas.height);
    const data = imageData.data;

    for (let x = 0; x < colorWheelCanvas.width; x++) {
      for (let y = 0; y < colorWheelCanvas.height; y++) {
        const dx = x - wheelRadius;
        const dy = y - wheelRadius;
        const distance = Math.sqrt(dx * dx + dy * dy);
        if (distance > wheelRadius) {
          // fuera del círculo: transparente
          const index = (y * colorWheelCanvas.width + x) * 4;
          data[index + 3] = 0;
          continue;
        }

        // ángulo en radianes [0, 2PI]
        let angle = Math.atan2(dy, dx);
        if (angle < 0) angle += 2 * Math.PI;

        // hue [0, 360)
        const hue = angle * 180 / Math.PI;

        // saturación proporcional a la distancia
        const saturation = distance / wheelRadius;

        // brillo fijo 1 (puedes ajustar)
        const value = 1;

        // convert HSV a RGB
        const rgb = hsvToRgb(hue, saturation, value);

        const index = (y * colorWheelCanvas.width + x) * 4;
        data[index] = rgb[0];
        data[index + 1] = rgb[1];
        data[index + 2] = rgb[2];
        data[index + 3] = 255;
      }
    }
    ctx.putImageData(imageData, 0, 0);
  }

  // Convertir HSV a RGB
  function hsvToRgb(h, s, v) {
    h /= 60;
    let c = v * s;
    let x = c * (1 - Math.abs(h % 2 - 1));
    let m = v - c;
    let r=0,g=0,b=0;

    if (h >= 0 && h < 1) [r,g,b] = [c,x,0];
    else if (h < 2) [r,g,b] = [x,c,0];
    else if (h < 3) [r,g,b] = [0,c,x];
    else if (h < 4) [r,g,b] = [0,x,c];
    else if (h < 5) [r,g,b] = [x,0,c];
    else [r,g,b] = [c,0,x];

    return [Math.round((r+m)*255), Math.round((g+m)*255), Math.round((b+m)*255)];
  }

  // Convertir RGB a Hex
  function rgbToHex(r, g, b) {
    return "#" + [r, g, b].map(x => {
      const hex = x.toString(16);
      return hex.length === 1 ? "0" + hex : hex;
    }).join('');
  }

  // Mostrar filamentos en lista
  function displayFilaments(list) {
    filamentList.innerHTML = '';
    if (list.length === 0) {
      filamentList.innerHTML = '<p style="text-align:center;color:#7ee8fa;">No se encontraron filamentos.</p>';
      return;
    }
    for (const filament of list) {
      const item = document.createElement('a');
      item.className = 'filament-item';
      item.href = filament.link;
      item.target = '_blank';
      item.rel = 'noopener noreferrer';
      item.setAttribute('role', 'listitem');

      const colorBox = document.createElement('div');
      colorBox.className = 'color-box';
      colorBox.style.backgroundColor = filament.hex;

      const info = document.createElement('div');
      info.className = 'filament-info';

      const name = document.createElement('div');
      name.className = 'filament-name';
      name.textContent = filament.name;

      const hex = document.createElement('div');
      hex.className = 'filament-hex';
      hex.textContent = filament.hex;

      info.appendChild(name);
      info.appendChild(hex);
      item.appendChild(colorBox);
      item.appendChild(info);

      filamentList.appendChild(item);
    }
  }

  // Mostrar colores en el panel derecho
  function displayClosestColors(colors) {
    closestColorsList.innerHTML = '';
    if (colors.length === 0) {
      closestColorsList.innerHTML = '<p style="text-align:center;color:#7ee8fa;">No hay colores disponibles.</p>';
      return;
    }
    for (const filament of colors) {
      const item = document.createElement('a');
      item.className = 'filament-item';
      item.href = filament.link;
      item.target = '_blank';
      item.rel = 'noopener noreferrer';
      item.setAttribute('role', 'listitem');

      const colorBox = document.createElement('div');
      colorBox.className = 'color-box';
      colorBox.style.backgroundColor = filament.hex;

      const info = document.createElement('div');
      info.className = 'filament-info';

      const name = document.createElement('div');
      name.className = 'filament-name';
      name.textContent = filament.name;

      const hex = document.createElement('div');
      hex.className = 'filament-hex';
      hex.textContent = filament.hex;

      info.appendChild(name);
      info.appendChild(hex);
      item.appendChild(colorBox);
      item.appendChild(info);

      closestColorsList.appendChild(item);
    }
  }

  // Filtrar filamentos por búsqueda (nombre o hex)
  function filterFilaments(query) {
    const lowerQuery = query.toLowerCase();
    return filaments.filter(f => f.name.toLowerCase().includes(lowerQuery) || f.hex.toLowerCase().includes(lowerQuery));
  }

  // Calcular distancia de color Euclidiana en RGB
  function colorDistance(c1, c2) {
    return Math.sqrt(
      Math.pow(c1[0] - c2[0], 2) +
      Math.pow(c1[1] - c2[1], 2) +
      Math.pow(c1[2] - c2[2], 2)
    );
  }

  // Convertir hex a RGB
  function hexToRgb(hex) {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? [
      parseInt(result[1], 16),
      parseInt(result[2], 16),
      parseInt(result[3], 16)
    ] : null;
  }

  // Obtener colores más cercanos al color seleccionado (top 5)
  function getClosestColors(hex) {
    const targetRgb = hexToRgb(hex);
    if (!targetRgb) return [];
    const sorted = filaments.slice().sort((a, b) => {
      const distA = colorDistance(hexToRgb(a.hex), targetRgb);
      const distB = colorDistance(hexToRgb(b.hex), targetRgb);
      return distA - distB;
    });
    return sorted.slice(0, 5);
  }

  // Actualizar color seleccionado y preview
  function updateSelectedColor(newHex) {
    selectedColorDisplay.textContent = newHex;
    colorPreview.style.backgroundColor = newHex;
    // Actualizar lista de colores cercanos
    const closest = getClosestColors(newHex);
    displayClosestColors(closest);
  }

  // Manejar click en la rueda de color
  colorWheelCanvas.addEventListener('click', (e) => {
    const rect = colorWheelCanvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const dx = x - wheelRadius;
    const dy = y - wheelRadius;
    const distance = Math.sqrt(dx * dx + dy * dy);
    if (distance > wheelRadius) return; // fuera del círculo
    let angle = Math.atan2(dy, dx);
    if (angle < 0) angle += 2 * Math.PI;
    const hue = angle * 180 / Math.PI;
    const saturation = distance / wheelRadius;
    const value = 1;
    const rgb = hsvToRgb(hue, saturation, value);
    const hex = rgbToHex(rgb[0], rgb[1], rgb[2]);
    updateSelectedColor(hex);
  });

  // Manejar búsqueda en input
  searchInput.addEventListener('input', () => {
    const filtered = filterFilaments(searchInput.value);
    displayFilaments(filtered);
  });

  // Botón generar idea 3D aleatoria
  suggestionBtn.addEventListener('click', () => {
    const randomIdea = ideas[Math.floor(Math.random() * ideas.length)];
    const currentColor = selectedColorDisplay.textContent;
    suggestionText.textContent = `Idea: ${randomIdea} usando color ${currentColor}`;
  });

  // Inicialización
  drawColorWheel();
  displayFilaments(filaments);
  updateSelectedColor("#5de1df");

</script>
</body>
</html>


