<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Buscador Filamentos Hoho3D - Profesional</title>
<style>
  /* Reset básico */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; background: #071821;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #cce7e0;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }

  /* Layout general */
  #app {
    display: flex;
    flex-grow: 1;
    padding: 20px;
    gap: 20px;
  }

  /* Panel Izquierdo - Buscador + Lista */
  #left-panel {
    width: 300px;
    background: #0b2a3d;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
  }

  #left-panel h2 {
    margin: 0 0 10px 0;
    font-weight: 700;
    color: #7ee8d9;
    user-select: none;
  }

  #search-input {
    padding: 10px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
    margin-bottom: 15px;
    background: #143d53;
    color: #cce7e0;
    outline: none;
    transition: background-color 0.3s ease;
  }
  #search-input::placeholder {
    color: #88b6b1;
  }
  #search-input:focus {
    background: #1d586d;
  }

  #filament-list {
    overflow-y: auto;
    flex-grow: 1;
    border-top: 1px solid #255a71;
    padding-top: 10px;
  }

  .filament-item {
    display: flex;
    align-items: center;
    padding: 8px 6px;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  .filament-item:hover {
    background: #1f4c62;
  }
  .color-box {
    width: 20px;
    height: 20px;
    border-radius: 4px;
    margin-right: 12px;
    border: 1.5px solid #255a71;
    flex-shrink: 0;
  }
  .filament-name {
    font-weight: 600;
    font-size: 14px;
    color: #b0e1db;
  }
  .filament-hex {
    margin-left: auto;
    font-family: monospace;
    font-size: 12px;
    color: #87ccc7;
  }

  /* Panel Central - Rueda hex + Cubo 3D + Colores cercanos */
  #center-panel {
    flex-grow: 1;
    background: #0b2a3d;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #center-panel h2 {
    color: #7ee8d9;
    user-select: none;
    margin: 0 0 12px 0;
  }

  /* Rueda hex */
  #hex-wheel {
    width: 250px;
    height: 250px;
    border-radius: 50%;
    background: conic-gradient(
      #5b6770 0deg 60deg,
      #e7b78a 60deg 120deg,
      #75787b 120deg 180deg,
      #a1561c 180deg 240deg,
      #998542 240deg 300deg,
      #5b6770 300deg 360deg
    );
    margin-bottom: 18px;
    cursor: grab;
    user-select: none;
    box-shadow: 0 0 15px #1a8999cc inset;
    transition: box-shadow 0.2s ease;
  }
  #hex-wheel:active {
    cursor: grabbing;
    box-shadow: 0 0 25px #28c6ffcc inset;
  }

  /* Cubo 3D */
  #cube-container {
    width: 200px;
    height: 200px;
    margin-bottom: 20px;
  }

  /* Colores cercanos */
  #nearest-colors {
    width: 100%;
    max-width: 600px;
    display: flex;
    justify-content: center;
    gap: 20px;
  }

  .nearest-color {
    display: flex;
    align-items: center;
    gap: 10px;
    background: #14475a;
    padding: 10px 14px;
    border-radius: 8px;
    user-select: none;
    box-shadow: 0 0 8px #28c6ff88;
    min-width: 120px;
  }
  .nearest-color .color-swatch {
    width: 24px;
    height: 24px;
    border-radius: 6px;
    border: 1.5px solid #255a71;
    flex-shrink: 0;
  }
  .nearest-color .color-name {
    font-weight: 600;
    font-size: 14px;
    color: #b0e1db;
  }
  .nearest-color .color-hex {
    font-family: monospace;
    font-size: 13px;
    color: #87ccc7;
  }

  /* Panel Derecho - Ideas sugeridas */
  #right-panel {
    width: 320px;
    background: #0b2a3d;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #right-panel h2 {
    margin: 0 0 15px 0;
    color: #7ee8d9;
    user-select: none;
  }

  #suggestion-btn {
    background: #28c6ff;
    border: none;
    color: #071821;
    padding: 14px 28px;
    font-size: 16px;
    font-weight: 700;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 15px #28c6ffcc;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  #suggestion-btn:hover {
    background: #00a9e0;
  }
  #suggestion-display {
    margin-top: 25px;
    background: #14475a;
    border-radius: 12px;
    padding: 18px;
    color: #cce7e0;
    width: 100%;
    min-height: 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: inset 0 0 15px #28c6ff55;
    font-size: 16px;
    font-weight: 600;
  }
  #suggestion-color {
    margin-top: 12px;
    width: 60px;
    height: 60px;
    border-radius: 12px;
    border: 2px solid #255a71;
    box-shadow: 0 0 12px #28c6ffbb;
  }

  /* Colores disponibles abajo centro */
  #all-colors {
    margin-top: 30px;
    width: 100%;
    max-width: 900px;
    background: #0b2a3d;
    border-radius: 12px;
    padding: 18px 25px;
    overflow-x: auto;
    white-space: nowrap;
    user-select: none;
    box-shadow: 0 0 20px #28c6ff44 inset;
  }
  .color-item {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin-right: 16px;
    padding: 8px 14px;
    border-radius: 10px;
    background: #14475a;
    cursor: default;
    border: 1.5px solid #255a71;
  }
  .color-item .color-swatch {
    width: 24px;
    height: 24px;
    border-radius: 6px;
    border: 1.5px solid #255a71;
  }
  .color-item .color-name {
    font-weight: 600;
    font-size: 14px;
    color: #b0e1db;
  }
  .color-item .color-hex {
    font-family: monospace;
    font-size: 12px;
    color: #87ccc7;
  }

</style>
</head>
<body>

<div id="app">

  <!-- Izquierda: Buscador + lista -->
  <section id="left-panel">
    <h2>Filamentos Hoho3D</h2>
    <input
      type="text"
      id="search-input"
      placeholder="Buscar por nombre o hex..."
      autocomplete="off"
      spellcheck="false"
    />
    <div id="filament-list" aria-live="polite"></div>
  </section>

  <!-- Centro: Rueda + cubo 3D + colores cercanos -->
  <section id="center-panel">
    <h2>Rueda Hexagonal</h2>
    <div id="hex-wheel" aria-label="Rueda de colores hexagonales" tabindex="0"></div>
    <div id="cube-container" aria-label="Cubo 3D giratorio"></div>
    <div id="nearest-colors" aria-label="Colores más cercanos"></div>
  </section>

  <!-- Derecha: Sugerencias -->
  <section id="right-panel">
    <h2>Ideas Sugeridas</h2>
    <button id="suggestion-btn" aria-describedby="suggestion-desc">Generar Sugerencia</button>
    <div id="suggestion-display" aria-live="polite" aria-atomic="true" aria-describedby="suggestion-color">
      Aquí aparecerán tus ideas...
      <div id="suggestion-color" role="img" aria-label="Muestra del color sugerido"></div>
    </div>
  </section>

</div>

<!-- Colores disponibles abajo centro -->
<div id="all-colors" aria-label="Listado completo de colores disponibles"></div>

<!-- Librería Three.js para cubo 3D -->
<script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>

<script>
  'use strict';

  /**
   * Stock de filamentos: nombre y color hexadecimal
   * @type {Array<{name:string, hex:string}>}
   */
  const filaments = [
    { name: 'Piedra Gris', hex: '#5b6770' },
    { name: 'Madera Claro', hex: '#e7b78a' },
    { name: 'Concreto', hex: '#75787b' },
    { name: 'Cobre', hex: '#a1561c' },
    { name: 'Oro Viejo', hex: '#998542' },
    { name: 'Madera Oscuro', hex: '#5b6770' },
  ];

  // Estado
  let filteredFilaments = [...filaments];
  let selectedFilament = null;

  /** 
   * Función para crear elemento HTML de un filamento
   * @param {object} filament 
   */
  function createFilamentElement(filament) {
    const item = document.createElement('div');
    item.classList.add('filament-item');
    item.setAttribute('tabindex', '0'); // accesibilidad

    const colorBox = document.createElement('div');
    colorBox.className = 'color-box';
    colorBox.style.backgroundColor = filament.hex;

    const name = document.createElement('span');
    name.className = 'filament-name';
    name.textContent = filament.name;

    const hexCode = document.createElement('span');
    hexCode.className = 'filament-hex';
    hexCode.textContent = filament.hex.toUpperCase();

    item.appendChild(colorBox);
    item.appendChild(name);
    item.appendChild(hexCode);

    // Selección al click y teclado
    item.addEventListener('click', () => {
      selectFilament(filament);
    });
    item.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        selectFilament(filament);
      }
    });

    return item;
  }

  /** Actualiza lista visible según filtro */
  function renderFilamentList() {
    const listContainer = document.getElementById('filament-list');
    listContainer.innerHTML = '';
    if (filteredFilaments.length === 0) {
      const empty = document.createElement('p');
      empty.textContent = 'No se encontraron filamentos.';
      empty.style.color = '#a07d5c';
      listContainer.appendChild(empty);
      return;
    }
    filteredFilaments.forEach(fil => {
      listContainer.appendChild(createFilamentElement(fil));
    });
  }

  /** Maneja la selección del filamento */
  function selectFilament(filament) {
    selectedFilament = filament;
    updateNearestColors();
    updateSuggestionDisplay(''); // limpia sugerencia cuando cambia selección
  }

  /** Filtra filamentos según texto */
  function filterFilaments(text) {
    text = text.trim().toLowerCase();
    filteredFilaments = filaments.filter(f => 
      f.name.toLowerCase().includes(text) || f.hex.toLowerCase().includes(text)
    );
    renderFilamentList();
  }

  /** Convierte hex a rgb */
  function hexToRgb(hex) {
    const cleanHex = hex.replace('#', '');
    const bigint = parseInt(cleanHex, 16);
    return {
      r: (bigint >> 16) & 255,
      g: (bigint >> 8) & 255,
      b: bigint & 255,
    };
  }

  /** Calcula distancia euclidiana en RGB */
  function colorDistance(c1, c2) {
    return Math.sqrt(
      Math.pow(c1.r - c2.r, 2) +
      Math.pow(c1.g - c2.g, 2) +
      Math.pow(c1.b - c2.b, 2)
    );
  }

  /** Ordena y devuelve 3 colores más cercanos al seleccionado */
  function getNearestColors(selected) {
    if (!selected) return [];
    const selRgb = hexToRgb(selected.hex);
    const others = filaments.filter(f => f.hex !== selected.hex);
    others.sort((a, b) => {
      return colorDistance(selRgb, hexToRgb(a.hex)) - colorDistance(selRgb, hexToRgb(b.hex));
    });
    return others.slice(0, 3);
  }

  /** Actualiza display de colores más cercanos */
  function updateNearestColors() {
    const container = document.getElementById('nearest-colors');
    container.innerHTML = '';

    if (!selectedFilament) {
      container.textContent = 'Selecciona un filamento para ver colores cercanos.';
      container.style.color = '#a07d5c';
      return;
    }

    container.style.color = '#cce7e0';

    const nearest = getNearestColors(selectedFilament);
    nearest.forEach(f => {
      const div = document.createElement('div');
      div.classList.add('nearest-color');

      const swatch = document.createElement('div');
      swatch.className = 'color-swatch';
      swatch.style.backgroundColor = f.hex;

      const name = document.createElement('span');
      name.className = 'color-name';
      name.textContent = f.name;

      const hex = document.createElement('span');
      hex.className = 'color-hex';
      hex.textContent = f.hex.toUpperCase();

      div.appendChild(swatch);
      div.appendChild(name);
      div.appendChild(hex);

      container.appendChild(div);
    });
  }

  /** Actualiza display de sugerencia */
  function updateSuggestionDisplay(text, color) {
    const display = document.getElementById('suggestion-display');
    const colorBox = document.getElementById('suggestion-color');

    display.textContent = text || 'Aquí aparecerán tus ideas...';
    display.appendChild(colorBox);

    if (color) {
      colorBox.style.backgroundColor = color;
      colorBox.setAttribute('aria-label', `Color sugerido ${color.toUpperCase()}`);
      colorBox.style.display = 'block';
    } else {
      colorBox.style.display = 'none';
    }
  }

  /** Genera una sugerencia aleatoria */
  function generateSuggestion() {
    // Ideas básicas relacionadas a impresión 3D y filamentos (puedes ampliar)
    const ideasBase = [
      "Impresión para decoración minimalista",
      "Figuras funcionales para escritorio",
      "Prototipos para ingeniería rápida",
      "Regalos personalizados con textura única",
      "Repuestos caseros para objetos rotos",
      "Accesorios prácticos para oficina",
      "Modelos artísticos con acabado mate",
      "Herramientas para hobby y bricolaje",
      "Utensilios para cocina impresos",
      "Juguetes educativos y divertidos",
    ];

    // Selecciona idea aleatoria
    const idea = ideasBase[Math.floor(Math.random() * ideasBase.length)];

    // Selecciona color aleatorio del stock
    const randomColor = filaments[Math.floor(Math.random() * filaments.length)];

    // Arma texto final con color
    const finalText = `${idea} - Color sugerido: ${randomColor.name}`;

    // Muestra
    updateSuggestionDisplay(finalText, randomColor.hex);
  }

  /** Renderiza la lista completa de colores abajo centro */
  function renderAllColors() {
    const container = document.getElementById('all-colors');
    container.innerHTML = '';

    filaments.forEach(f => {
      const item = document.createElement('div');
      item.className = 'color-item';

      const swatch = document.createElement('div');
      swatch.className = 'color-swatch';
      swatch.style.backgroundColor = f.hex;

      const name = document.createElement('span');
      name.className = 'color-name';
      name.textContent = f.name;

      const hex = document.createElement('span');
      hex.className = 'color-hex';
      hex.textContent = f.hex.toUpperCase();

      item.appendChild(swatch);
      item.appendChild(name);
      item.appendChild(hex);

      container.appendChild(item);
    });
  }

  /* -----------------------------------------------
     Cubo 3D con Three.js 
  -------------------------------------------------- */
  let scene, camera, renderer, cube;
  function initCube() {
    const container = document.getElementById('cube-container');

    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.z = 3;

    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    container.appendChild(renderer.domElement);

    // Luz suave
    const light1 = new THREE.DirectionalLight(0xffffff, 0.7);
    light1.position.set(3, 5, 2);
    scene.add(light1);
    scene.add(new THREE.AmbientLight(0x404040));

    // Cubo
    const geometry = new THREE.BoxGeometry(1, 1, 1);
    const materials = filaments.map(f => new THREE.MeshBasicMaterial({ color: f.hex }));
    // Para un cubo con 6 caras, solo se usan 6 materiales, aquí repetimos colores si más
    const cubeMaterials = materials.slice(0, 6);
    cube = new THREE.Mesh(geometry, cubeMaterials);
    scene.add(cube);

    animate();
  }

  function animate() {
    requestAnimationFrame(animate);
    if (cube) {
      cube.rotation.x += 0.01;
      cube.rotation.y += 0.01;
    }
    renderer.render(scene, camera);
  }

  /* -----------------------------------------------
     Eventos y configuración inicial
  -------------------------------------------------- */
  document.getElementById('search-input').addEventListener('input', e => {
    filterFilaments(e.target.value);
  });

  document.getElementById('suggestion-btn').addEventListener('click', () => {
    generateSuggestion();
  });

  // Render inicial
  renderFilamentList();
  renderAllColors();
  initCube();
  updateNearestColors();
  updateSuggestionDisplay();

</script>

</body>
</html>


