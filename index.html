<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Buscador de Filamentos Hoho3D</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
  body {
    margin: 0; 
    font-family: 'Montserrat', sans-serif;
    background: #0a1e28;
    color: #cde9f8;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }
  .container {
    display: flex;
    flex: 1;
    gap: 15px;
    padding: 20px;
  }
  /* Panel izquierdo */
  .left-panel {
    flex-basis: 280px;
    background: #12314a;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
  }
  .left-panel h2 {
    margin-top: 0;
    margin-bottom: 12px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1.3rem;
  }
  .left-panel h2 .color-preview {
    width: 22px;
    height: 22px;
    border-radius: 5px;
    border: 1.5px solid #3fb7a4;
  }
  .search-input {
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    margin-bottom: 15px;
    font-size: 1rem;
    outline: none;
    background: #0e3d53;
    color: #cde9f8;
  }
  .filaments-list {
    flex: 1;
    overflow-y: auto;
    border-top: 1px solid #3fb7a4;
    padding-top: 10px;
  }
  .filament-item {
    padding: 8px 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    border-radius: 6px;
    transition: background 0.2s ease;
  }
  .filament-item:hover, .filament-item.active {
    background: #1f6f7f;
  }
  .color-box {
    width: 20px;
    height: 20px;
    border-radius: 4px;
    border: 1.5px solid #3fb7a4;
    flex-shrink: 0;
  }
  .filament-info {
    flex: 1;
    font-size: 0.9rem;
    user-select: none;
  }
  /* Panel central */
  .center-panel {
    flex: 1;
    background: #12314a;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
  }
  .center-panel h1 {
    margin: 0 0 15px;
    font-weight: 700;
    color: #3fb7a4;
  }
  .color-preview-large {
    width: 130px;
    height: 130px;
    border-radius: 20px;
    border: 3px solid #3fb7a4;
    box-shadow: 0 0 20px #3fb7a4aa;
    margin-bottom: 20px;
  }
  button#randomIdeaBtn {
    background: #3fb7a4;
    border: none;
    border-radius: 25px;
    padding: 12px 30px;
    font-weight: 700;
    color: #0a1e28;
    cursor: pointer;
    font-size: 1.1rem;
    box-shadow: 0 4px 15px #3fb7a4cc;
    transition: background 0.3s ease;
    user-select: none;
  }
  button#randomIdeaBtn:hover {
    background: #2a8f81;
  }
  .idea-text {
    margin-top: 15px;
    font-size: 1.1rem;
    font-style: italic;
    min-height: 3.5em;
    text-align: center;
    color: #a6d9cc;
  }
  /* Panel derecho */
  .right-panel {
    flex-basis: 350px;
    background: #12314a;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  canvas#colorWheel {
    border-radius: 50%;
    background: #0a1e28;
    box-shadow: 0 0 12px #3fb7a4aa;
    cursor: pointer;
  }
  canvas#cubePreview {
    margin-top: 20px;
    border-radius: 20px;
    background: #0e3d53;
    box-shadow: 0 0 25px #3fb7a4bb;
  }
  .closest-colors {
    margin-top: 30px;
    width: 100%;
  }
  .closest-colors h3 {
    color: #3fb7a4;
    margin-bottom: 12px;
    font-weight: 700;
    font-size: 1.1rem;
  }
  .closest-colors-list {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
  }
  .closest-color-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 70px;
    font-size: 0.75rem;
    color: #a6d9cc;
    cursor: pointer;
    user-select: none;
  }
  .closest-color-box {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    border: 1.5px solid #3fb7a4;
    margin-bottom: 6px;
    box-shadow: 0 0 8px #3fb7a4aa;
  }
  .closest-color-label {
    text-align: center;
    word-break: break-word;
  }
</style>
</head>
<body>
<div class="container">

  <section class="left-panel">
    <h2><span>Filamentos</span> <span class="color-preview"></span></h2>
    <input type="text" class="search-input" placeholder="Buscar por nombre o hex..." id="searchInput" />
    <div class="filaments-list" id="filamentsList">
      <!-- Aquí se listan los filamentos -->
    </div>
  </section>

  <section class="center-panel">
    <h1>Color seleccionado</h1>
    <div class="color-preview-large" id="selectedColorPreview"></div>
    <button id="randomIdeaBtn">Generar idea de impresión 3D</button>
    <div class="idea-text" id="ideaText"></div>
  </section>

  <section class="right-panel">
    <canvas id="colorWheel" width="250" height="250" title="Rueda de colores"></canvas>
    <canvas id="cubePreview" width="180" height="180" title="Vista 3D"></canvas>
    <div class="closest-colors">
      <h3>Colores disponibles</h3>
      <div class="closest-colors-list" id="closestColorsList">
        <!-- Colores cerca o todos los colores -->
      </div>
    </div>
  </section>

</div>

<script>
  // Lista de filamentos con datos que me diste:
  const filaments = [
    {
      name: "Grilon 3 PLA SILK Platino 1.75mm x 1kg",
      hex: "#5b6770",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/silk/grilon-3-pla-silk-platino-175mm-x-1kg-5b6770"
    },
    {
      name: "Grilon 3 PLA Piel 720 1.75mm x 1KG",
      hex: "#e7b78a",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-piel-720-175mm-x-1kg-e7b78a"
    },
    
    },
    {
      name: "Grilon 3 PLA Gris Plata 1.75mm x 1kg",
      hex: "#75787b",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-gris-plata-175mm-x-1kg-75787b"
    },
    {
      name: "Grilon 3 PLA Cobre 1.75mm x 1kg",
      hex: "#a1561c",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-cobre-175mm-x-1kg-a1561c"
    },
    {
      name: "Grilon 3 PLA Bronce 1.75mm x 1kg",
      hex: "#998542",
      link: "https://www.hoho3d.com.ar/impresion-3d/filamentos/grilon-3/basicos/grilon-3-pla-bronce-175mm-x-1kg-998542"
    }
  ];

  const filamentsListEl = document.getElementById('filamentsList');
  const searchInput = document.getElementById('searchInput');
  const selectedColorPreview = document.getElementById('selectedColorPreview');
  const randomIdeaBtn = document.getElementById('randomIdeaBtn');
  const ideaText = document.getElementById('ideaText');
  const closestColorsList = document.getElementById('closestColorsList');

  let selectedFilament = filaments[0]; // inicializo con primer color

  // Mostrar filamentos en la lista
  function renderFilamentsList(filter = '') {
    filamentsListEl.innerHTML = '';
    const fFiltered = filaments.filter(f => 
      f.name.toLowerCase().includes(filter.toLowerCase()) || 
      f.hex.toLowerCase().includes(filter.toLowerCase())
    );
    fFiltered.forEach((filament, i) => {
      const div = document.createElement('div');
      div.className = 'filament-item' + (filament === selectedFilament ? ' active' : '');
      div.innerHTML = `<div class="color-box" style="background:${filament.hex}"></div>
                       <div class="filament-info" title="${filament.name}">${filament.name}</div>`;
      div.onclick = () => {
        selectedFilament = filament;
        renderFilamentsList(searchInput.value);
        updateSelectedColor(filament.hex);
      };
      filamentsListEl.appendChild(div);
    });
  }

  // Mostrar colores en panel derecho
  function renderClosestColors() {
    closestColorsList.innerHTML = '';
    filaments.forEach(filament => {
      const div = document.createElement('div');
      div.className = 'closest-color-item';
      div.title = filament.name + ' ' + filament.hex;
      div.onclick = () => {
        selectedFilament = filament;
        renderFilamentsList(searchInput.value);
        updateSelectedColor(filament.hex);
      };
      div.innerHTML = `
        <div class="closest-color-box" style="background:${filament.hex}"></div>
        <div class="closest-color-label">${filament.hex}</div>
      `;
      closestColorsList.appendChild(div);
    });
  }

  // Actualiza panel central y color rueda
  function updateSelectedColor(color) {
    selectedColorPreview.style.backgroundColor = color;
    leftPanelColorPreview.style.backgroundColor = color;
    selectedColorHex = color;
    draw3DPreview(color);
    ideaText.textContent = '';
  }

  // Buscador
  searchInput.addEventListener('input', () => {
    renderFilamentsList(searchInput.value);
  });

  // Inicializar color panel izquierdo
  const leftPanelColorPreview = document.querySelector('.left-panel .color-preview');

  // Render inicial
  renderFilamentsList();
  renderClosestColors();
  updateSelectedColor(selectedFilament.hex);

</script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>

<script>
  // Variables para rueda color
  const canvasWheel = document.getElementById('colorWheel');
  const ctx = canvasWheel.getContext('2d');
  const radius = canvasWheel.width / 2;
  const center = { x: radius, y: radius };

  let selectedHue = 0;
  let isDragging = false;

  // Función para dibujar rueda de colores
  function drawColorWheel() {
    const image = ctx.createImageData(canvasWheel.width, canvasWheel.height);
    const data = image.data;

    for (let y = 0; y < canvasWheel.height; y++) {
      for (let x = 0; x < canvasWheel.width; x++) {
        const dx = x - center.x;
        const dy = y - center.y;
        const dist = Math.sqrt(dx * dx + dy * dy);

        if (dist <= radius) {
          let hue = Math.atan2(dy, dx) * 180 / Math.PI;
          if (hue < 0) hue += 360;

          const saturation = dist / radius;
          const value = 1;

          const rgb = HSVtoRGB(hue, saturation, value);

          const idx = (y * canvasWheel.width + x) * 4;
          data[idx] = rgb.r;
          data[idx + 1] = rgb.g;
          data[idx + 2] = rgb.b;
          data[idx + 3] = 255;
        }
      }
    }
    ctx.putImageData(image, 0, 0);

    // Marca círculo selección
    const angle = selectedHue * Math.PI / 180;
    const sx = center.x + Math.cos(angle) * radius * 0.9;
    const sy = center.y + Math.sin(angle) * radius * 0.9;
    ctx.strokeStyle = '#3fb7a4';
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.arc(sx, sy, 12, 0, Math.PI * 2);
    ctx.stroke();
  }

  // Conversión HSV a RGB
  function HSVtoRGB(h, s, v) {
    let c = v * s;
    let x = c * (1 - Math.abs((h / 60) % 2 - 1));
    let m = v - c;
    let r, g, b;

    if (h < 60) [r, g, b] = [c, x, 0];
    else if (h < 120) [r, g, b] = [x, c, 0];
    else if (h < 180) [r, g, b] = [0, c, x];
    else if (h < 240) [r, g, b] = [0, x, c];
    else if (h < 300) [r, g, b] = [x, 0, c];
    else [r, g, b] = [c, 0, x];

    return {
      r: Math.round((r + m) * 255),
      g: Math.round((g + m) * 255),
      b: Math.round((b + m) * 255)
    };
  }

  // Detecta clic y movimiento para seleccionar hue
  canvasWheel.addEventListener('mousedown', (e) => {
    isDragging = true;
    selectHue(e);
  });
  window.addEventListener('mouseup', () => isDragging = false);
  canvasWheel.addEventListener('mousemove', (e) => {
    if (isDragging) selectHue(e);
  });

  function selectHue(e) {
    const rect = canvasWheel.getBoundingClientRect();
    const x = e.clientX - rect.left - center.x;
    const y = e.clientY - rect.top - center.y;
    const dist = Math.sqrt(x * x + y * y);

    if (dist <= radius) {
      let hue = Math.atan2(y, x) * 180 / Math.PI;
      if (hue < 0) hue += 360;
      selectedHue = hue;
      drawColorWheel();

      // Actualizar color central con hue + saturation=1, value=1 para un color fuerte
      const rgb = HSVtoRGB(selectedHue, 1, 1);
      const hexColor = rgbToHex(rgb.r, rgb.g, rgb.b);
      updateSelectedColor(hexColor);
    }
  }

  function rgbToHex(r, g, b) {
    return "#" + [r, g, b].map(x => x.toString(16).padStart(2, '0')).join('');
  }

  drawColorWheel();

  // THREE.js para cubo 3D rotatorio
  const canvasCube = document.getElementById('cubePreview');
  const renderer = new THREE.WebGLRenderer({ canvas: canvasCube, alpha: true, antialias: true });
  renderer.setSize(canvasCube.width, canvasCube.height);
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(45, canvasCube.width / canvasCube.height, 0.1, 100);
  camera.position.z = 4;

  const geometry = new THREE.BoxGeometry(2, 2, 2);
  let material = new THREE.MeshStandardMaterial({ color: selectedFilament.hex, roughness: 0.4, metalness: 0.6 });
  const cube = new THREE.Mesh(geometry, material);
  scene.add(cube);

  const light1 = new THREE.DirectionalLight('#3fb7a4', 0.8);
  light1.position.set(5, 5, 5);
  scene.add(light1);

  const ambientLight = new THREE.AmbientLight('#3fb7a4', 0.3);
  scene.add(ambientLight);

  function draw3DPreview(color) {
    cube.material.color.set(color);
  }

  function animate() {
    requestAnimationFrame(animate);
    cube.rotation.x += 0.005;
    cube.rotation.y += 0.008;
    renderer.render(scene, camera);
  }
  animate();

  // Ideas random con base en colores en stock
  const ideasBase = [
    "Pieza funcional para unir módulos con color ",
    "Soporte personalizado para tu escritorio en ",
    "Accesorio decorativo para el hogar en color ",
    "Protoboard compacto para electrónica en ",
    "Base para plantas con textura silk en ",
    "Carcasa para dispositivos en tono ",
    "Llaveros personalizados con el tono ",
    "Figuras artísticas con acabado brillante en "
  ];

  randomIdeaBtn.onclick = () => {
    // Elige un color del stock al azar
    const randomFilament = filaments[Math.floor(Math.random() * filaments.length)];
    const randomIdea = ideasBase[Math.floor(Math.random() * ideasBase.length)];
    ideaText.textContent = randomIdea + randomFilament.name + " (" + randomFilament.hex + ")";
    updateSelectedColor(randomFilament.hex);
  };

</script>
</body>
</html>
